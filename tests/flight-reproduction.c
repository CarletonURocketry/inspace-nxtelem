#include "flight-reproduction.h"

// Auto-generated
static const int N_INTERVALS = 99;
static const double x_knots[100] = {-0.14000000000000001, 1.5700000000000001, 3.2799999999999998, 5, 6.71, 8.4299999999999997, 10.140000000000001, 11.85, 13.57, 15.279999999999999, 17, 18.710000000000001, 20.43, 22.140000000000001, 23.850000000000001, 25.57, 27.280000000000001, 29, 30.710000000000001, 32.43, 34.140000000000001, 35.850000000000001, 37.57, 39.280000000000001, 55.579999999999998, 72.680000000000007, 89.879999999999995, 106.98, 124.08, 141.28, 158.38, 175.58000000000001, 192.68000000000001, 209.88, 226.97999999999999, 244.08000000000001, 261.27999999999997, 278.38, 295.57999999999998, 312.68000000000001, 329.77999999999997, 346.98000000000002, 364.07999999999998, 381.27999999999997, 398.38, 415.57999999999998, 432.68000000000001, 449.77999999999997, 466.98000000000002, 484.07999999999998, 501.27999999999997, 518.38, 535.58000000000004, 552.67999999999995, 569.77999999999997, 586.98000000000002, 604.08000000000004, 621.27999999999997, 638.38, 655.58000000000004, 672.67999999999995, 689.77999999999997, 706.98000000000002, 724.08000000000004, 741.27999999999997, 758.38, 775.58000000000004, 792.67999999999995, 809.77999999999997, 826.98000000000002, 844.08000000000004, 861.27999999999997, 878.38, 895.48000000000002, 912.67999999999995, 929.77999999999997, 946.98000000000002, 964.08000000000004, 981.27999999999997, 998.38, 1015.48, 1032.6800000000001, 1049.78, 1066.98, 1084.0799999999999, 1101.28, 1118.3800000000001, 1135.48, 1152.6800000000001, 1169.78, 1186.98, 1204.0799999999999, 1221.28, 1238.3800000000001, 1255.48, 1272.6800000000001, 1289.6800000000001, 1306.8800000000001, 1323.98, 1341.23};
static const double coeff_a[99] = {34.071829446849243, -23.543342861190876, -34.144052423325228, 23.961639823772824, -4.326289526954767, 3.2094758620280612, -3.4857148539516145, 5.8295176529311057, -3.0530962307409504, 0.35211472362802371, 0.65585920580220203, -0.78916329278174802, 0.61276725095511519, -0.39561857184336147, 0.50474984408773516, -0.30867805387928487, 0.028661986379018688, 0.1606342927475726, 0.064613167372846878, -0.41993197834826107, 0.56212242657398415, -0.42556164126360241, 0.57300182203973282, 0.07483797072231152, -0.026336836323430136, 0.0052897309817719271, -0.00027955244038080249, -0.00022724162338588736, -0.00010991755635889239, 0.0002773321940392889, -0.00049683174055106772, 0.00030071536739602317, 3.2930576398403241e-05, -9.9183227397296579e-05, -0.00014747568591017978, 0.00036871277471437299, -0.00073182259247513268, 0.00072043922308867472, -0.00016692293879146146, 0.00018295477380213834, -0.00030813240750705552, -0.00019274742875461133, 0.000393174684000831, -0.00035738844784031045, 0.00033429646237091525, 0.00012195090413169689, -0.00056153736161015369, 0.00062823713773529043, -0.00028571045905890612, 5.2247416837619424e-05, 5.84539186375278e-06, -0.00031953924123893023, 0.00033696143401640153, -2.2195378965068189e-05, 0.00011170641499579809, -0.00038143721512653647, 0.00039005465346725001, -0.00039302418336199021, 0.0003384390912983807, -0.00028190125872166576, 0.00026562932534014125, -0.00039882379545190457, 0.00052009659689972144, -0.00025478971242684696, 4.3238182791624808e-05, -4.132651774268781e-05, -0.00023363749153981419, 0.00051597514910045334, -0.00064137244988766854, 0.00072934666828382126, -0.00015410333887661465, -0.00028834473690684273, 0.00018214364941792445, -9.3750417642923041e-05, 1.8865739808101942e-05, -0.00017167769979731571, 6.1152374762807931e-05, 0.00021235493650797246, -0.00033276672579177875, 0.00029567746197555188, -0.00026850760580034475, 0.00047201720013043201, -0.00048633790455079976, 0.0001764407398972934, -0.00014513942000766745, 0.00046559588941003381, -0.00015693461457830297, -0.00032911068032905516, 0.0003179213422419849, -0.00011975891388558194, -0.00024454864807901236, 0.00037470249903675883, -3.0933625888407735e-05, -0.00049284482570475401, 0.0002774286293260183, 9.478585320462553e-05, -0.00059563128354686416, 0.0051738257195461492, -0.0045373311063486178};
static const double coeff_b[99] = {-2.1316282072803006e-14, 174.78848506233686, 54.011136184427542, -122.17217431993049, 0.75103797602434152, -21.572615983062196, -5.1080048108580058, -22.989722011629759, 7.09058907749478, -8.5717945862061597, -6.7548826122855123, -3.390324886520192, -7.4624074772739331, -4.3189114798741572, -6.3484347534306469, -3.7439255579378767, -5.3274439743385598, -5.1795481246227908, -4.3554942028277335, -4.0220902591838783, -6.1763413081104632, -3.2926532597859088, -5.4885513287059924, -2.5490519816421608, 1.1105247866788717, -0.24055491671309517, 0.0323952019463358, 0.01805416175480095, 0.006396666475104805, 0.00072492056698599764, 0.014952062121201929, -0.010684455691233535, 0.0047422426561831172, 0.006441460398340473, 0.0013533608328590028, -0.0062121418543332179, 0.012813437320927802, -0.024729061673046972, 0.012445602238328203, 0.0038824554783259699, 0.013268035374375514, -0.0026315968529886961, -0.012519539948100074, 0.0077682737463431184, -0.010565753627864775, 0.006683943830474234, 0.012940025212430232, -0.015866841438170506, 0.016550194868970386, 0.0018932483192486739, 0.0045892150280701606, 0.0048890836306804703, -0.011599141217248282, 0.0056869803477930378, 0.0045483574068848837, 0.010312408420668474, -0.00925532071532271, 0.01087149940358766, -0.0092906412028827441, 0.0081728159081139035, -0.0062887186643071705, 0.0073380657256422108, -0.013241242119676054, 0.013439713301280007, 0.00029256414005461378, 0.002510682917264966, 0.00037823460174214946, -0.011607368714250124, 0.014862156434603303, -0.018232661979600533, 0.019182822103359434, 0.011231089817326446, -0.0035609951859946563, 0.0057829740291452849, 0.0009454524787704282, 0.0019132649309260314, -0.0069453043786154231, -0.0038081875532829223, 0.0071493271705286108, -0.0099216058625895588, 0.0052466479367564737, -0.0086083445225412052, 0.015606137844149695, -0.0094888980306714141, -0.00043748807394054399, -0.0079266821463365826, 0.015958386980398295, 0.0079076412525315911, -0.0090744698524471874, 0.0072348950045667644, 0.0010553350480705225, -0.011490010598382859, 0.007844638351913822, 0.0062577433438382648, -0.019025196214815618, -0.0047098789415931505, 0.00012419957184303318, -0.030610374659175134, 0.23480688475354097};
static const double coeff_c[99] = {41.66880912850332, 340.55711858509886, 731.80447091706617, 614.56748532400081, 406.93734217592089, 371.12422800381569, 325.50036644621179, 277.4532535797577, 250.10674493304546, 247.57388351314879, 221.21199873174305, 203.86369390878525, 185.19699424305927, 165.05093882633599, 146.80977676738485, 129.4509170318309, 113.9388751316381, 95.866848721424532, 79.56192634148411, 65.152481066824194, 47.713163086750875, 31.521182375648046, 16.417510483441809, 2.6732088227464605, -20.774784455155149, -5.8982996787403579, -9.4786467727286112, -8.615962653439178, -8.1978534907077876, -8.0753621935838247, -7.8072857896158174, -7.7338829590203551, -7.8354948019197286, -7.6431351093819186, -7.5098436663284049, -7.5929288217956143, -7.4793865397701786, -7.6831437161914105, -7.8944192184685669, -7.6152094315137768, -7.3219360379325806, -7.1389892953647252, -7.3980737346633454, -7.4797955133335696, -7.527632419307591, -7.5943995478227047, -7.2588296771890377, -7.3088782346491978, -7.2971245556394368, -6.981741677120894, -6.8702433075470157, -6.7081644004823753, -6.8235773909713435, -6.9246753418390279, -6.7496510662340325, -6.49404589400012, -6.4759696942387102, -6.4481714208005583, -6.4211387455684994, -6.4403653406385262, -6.4081472777694373, -6.3902034430206092, -6.4917380769979927, -6.4883442197925705, -6.2521490478016135, -6.2042135231214495, -6.1545241417945258, -6.3465423351184125, -6.2908854651003754, -6.3488581604743262, -6.3326104223580479, -5.8094911373222571, -5.6783325191264824, -5.6403366809086144, -5.5246077449724629, -5.4757236772666529, -5.5622747557669117, -5.7461594678023804, -5.6886918663857582, -5.7360978320200031, -5.8160396125517515, -5.8738607938272516, -5.7541985280277448, -5.6489820032359219, -5.8187232056247824, -5.9625869334135428, -5.8252447807510865, -5.417135697967991, -5.4372051498865481, -5.4686618797853068, -5.3260699228799417, -5.5045028747902807, -5.5672032774295461, -5.3260525504321805, -5.5443759945258906, -5.9526192872161205, -6.0305758365018782, -6.5549380480039936, -3.063177725390358};
static const double coeff_d[99] = {1319.8599999999999, 1561.48, 2537.21, 3781.96, 4595.4399999999996, 5275.5799999999999, 5863.1700000000001, 6387.4099999999999, 6826.2799999999997, 7259.4300000000003, 7661.6899999999996, 8023.4899999999998, 8360.0900000000001, 8658.0200000000004, 8925.6499999999996, 9161.9500000000007, 9370.8199999999997, 9551.1800000000003, 9700.7700000000004, 9825.0599999999995, 9922.6100000000006, 9988.9500000000007, 10031.26, 10046.15, 9736.5699999999997, 9574.3600000000006, 9428.6599999999999, 9274.6499999999996, 9131.4599999999991, 8991.7900000000009, 8855.2999999999993, 8722.9099999999999, 8589.0400000000009, 8455.8400000000001, 8326.5300000000007, 8197.7700000000004, 8067.21, 7939.3999999999996, 7803.6000000000004, 7671.4099999999999, 7543.2399999999998, 7419.6599999999999, 7295.8500000000004, 7166.8999999999996, 7039.4799999999996, 6908.5799999999999, 6781.2799999999997, 6658.1300000000001, 6530.9200000000001, 6409.5500000000002, 6290.29, 6174.1800000000003, 6058.6199999999999, 5940.2299999999996, 5823.3699999999999, 5709.1899999999996, 5599.25, 5487.1099999999997, 5378.0600000000004, 5266.5900000000001, 5157.4399999999996, 5047.3500000000004, 4937.5799999999999, 4825.3000000000002, 4716.3800000000001, 4609.7700000000004, 4503.5900000000001, 4397.29, 4287.9499999999998, 4180.8800000000001, 4070.6300000000001, 3966.5999999999999, 3869.0999999999999, 3771.8699999999999, 3676.0900000000001, 3581.9899999999998, 3487.5, 3390.6599999999999, 3291.7800000000002, 3194.9299999999998, 3095.4200000000001, 2995.5700000000002, 2894.9699999999998, 2798.1399999999999, 2699.6500000000001, 2598.6999999999998, 2496.75, 2401.02, 2308.5100000000002, 2214.4699999999998, 2121.9400000000001, 2029.95, 1933.78, 1840.72, 1749.01, 1649.4300000000001, 1547.3399999999999, 1440.6199999999999, 1345.45};

/**
 * Calculates the altitude at a given time using cubic spline interpolation
 * @param t The time at which to calculate the altitude, in seconds. Valid from 0 to 1341 seconds
 * @return 
 */
double reproduce_flight_altitude(double t) {
    int i = 0;
    while (i < N_INTERVALS-1 && t >= x_knots[i+1]) { i++; }
    double dt = t - x_knots[i];
    return coeff_a[i] + coeff_b[i] * dt + coeff_c[i] * dt * dt + coeff_d[i] * dt * dt * dt;
}

/**
 * Calculates the velocity at a given time using cubic spline interpolation
 * @param t The time at which to calculate the velocity, in seconds. Valid from 0 to 1341 seconds
 * @return The velocity at time t in m/s
 */
double reproduce_flight_velocity(double t) {
    int i = 0;
    while (i < N_INTERVALS - 1 && t >= x_knots[i+1]) i++;
    double dt = t - x_knots[i];
    return coeff_b[i] + 2 * coeff_c[i] * dt + 3 * coeff_d[i] * dt * dt;
}

/**
 * Calculates the acceleration at a given time using cubic spline interpolation
 * @param t The time at which to calculate the acceleration, in seconds. Valid from 0 to 1341 seconds
 * @return The acceleration at time t in m/s^2
 */
double reproduce_flight_acceleration(double t) {
    int i = 0;
    while (i < N_INTERVALS - 1 && t >= x_knots[i+1]) i++;
    double dt = t - x_knots[i];
    return 2 * coeff_c[i] + 6 * coeff_d[i] * dt;
}
